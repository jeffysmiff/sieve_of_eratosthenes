<!DOCTYPE html>
<head>
	<style type="text/css">
		.container {
			height: 100%;
			width: 100%;
			display: flex;
			align-items: center;
			justify-content: center;
		}
		.box {
			width: 33%;
			margin-left: 50px;
			margin-right: 50px;
			margin-bottom: 50px;
			margin-top: 50px;
            height: 400px;
		}
	</style>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function baseName(str) {
            var base = new String(str).substring(str.lastIndexOf('/') + 1); 
            if(base.lastIndexOf(".") != -1)       
                base = base.substring(0, base.lastIndexOf("."));
            return base;
        }

        $( document ).ready(function() {
            var filenames = [
                "python.json",
                "node.json",
                "java.json"
            ];
            var charts = {
                "myChart100" : undefined,
                "myChart1000" : undefined,
                "myChart10000" : undefined,
                "myChart100000" : undefined,
                "myChart1000000" : undefined,
            }
            // initialise the charts with empty data
            for(const [key,value] of Object.entries(charts)) {
                let chartCtx = $('#' + key)[0].getContext('2d');
                charts[key] = new Chart(chartCtx, {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: [
                            ],
                            borderColor: [
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        },
                        plugins: {
                            display: true,
                            title: 'Duration to calc primes under ' + key.substring(7)
                        }
                    }
                });
            }
            console.log(filenames);
            let count = 1;
            for( let filename of filenames ) {
                let nodeRes = undefined;
                let basename = baseName(filename);
                $.when(
                    $.getJSON(filename, function(data){
                        nodeRes = data;
                    })
                ).then(function() {
                    let language = Object.keys(nodeRes)[0];
                    let red = 128 - Math.floor(Math.random() * 128);
                    let green = 128 - Math.floor(Math.random() * 128);
                    let blue = 128 - Math.floor(Math.random() * 128);
                    for(const [primeMax,primeRes] of Object.entries(nodeRes[language])) {
                        let chartName = "myChart" + primeMax;
                        charts[chartName].data.labels.push(language);
                        charts[chartName].data.datasets[0].backgroundColor.push("rgba(" + red + ", " + green + ", " + blue + ", 0.2)");
                        charts[chartName].data.datasets[0].borderColor.push("rgba(" + red + ", " + green + ", " + blue + ", 0.2)");
                        charts[chartName].data.datasets[0].data.push(primeRes.duration);
                        charts[chartName].update();
                    }
                    count++;
                });
            }
        });
    </script>
</head>
<html>
	<body>
		<div class="container">
			<div class="box" id="chartContainer100">
                <h1>Duration of primes under 100</h1>
                <canvas id="myChart100" height="80%" width="100%"></canvas>
            </div>
			<div class="box" id="chartContainer1000">
                <h1>Duration of primes under 1000</h1>
                <canvas id="myChart1000" height="80%" width="100%"></canvas>
            </div>
			<div class="box" id="chartContainer10000">
                <h1>Duration of primes under 10000</h1>
                <canvas id="myChart10000" height="80%" width="100%"></canvas>
            </div>
		</div>
		<div class="container">
			<div class="box" id="chartContainer100000">
                <h1>Duration of primes under 100000</h1>
                <canvas id="myChart100000" height="80%" width="100%"></canvas>
            </div>
			<div class="box" id="chartContainer1000000">
                <h1>Duration of primes under 1000000</h1>
                <canvas id="myChart1000000" height="80%" width="100%"></canvas>
            </div>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/chart.js@3.5.0/dist/chart.min.js"></script>
	</body>
</html>